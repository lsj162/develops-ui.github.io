var x=Object.defineProperty;var y=(o,e,t)=>e in o?x(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var n=(o,e,t)=>y(o,typeof e!="symbol"?e+"":e,t);import{r as u,j as l}from"./index-CKNvk7wi.js";import{$ as g}from"./event-BuLzmr3F.js";class C{constructor(e){n(this,"slider");n(this,"sliderProgress");n(this,"bufferProgress");n(this,"sliderBtn");n(this,"onMousedownChange");n(this,"onMouseupChange");n(this,"onMoveChange");n(this,"min");n(this,"radius");n(this,"max");n(this,"pointX");n(this,"progress");n(this,"animation");n(this,"vertical");n(this,"reverse");n(this,"callback");n(this,"onMousedown",e=>{let t=this;function s(i){t.onMousemove(i)}g.bind(document,"mousemove",s),g.one(document,"mouseup",function(){g.removeEvent(document,"mousemove",s),t.onMouseup()}),this.sliderBtn.style.opacity=.5,this.onMousedownChange&&this.onMousedownChange()});n(this,"onMousemove",e=>{this.clickMove(e)});n(this,"onMouseup",()=>{this.onMouseupChange&&this.onMouseupChange()});n(this,"bufferMove",e=>{this.vertical?(this.bufferProgress.style.left="0",this.bufferProgress.style.top="0",this.bufferProgress.style.width="100%",this.bufferProgress.style.height=this.rangeValue(e,0,100)+"%"):(this.bufferProgress.style.left="0",this.bufferProgress.style.top="0",this.bufferProgress.style.width=this.rangeValue(e,0,100)+"%",this.bufferProgress.style.height="100%")});n(this,"effect1",e=>{const t=this.slider.getBoundingClientRect().width||100,s=this.slider.getBoundingClientRect().height||100;let i=e+this.radius/2,a=e+this.radius/2;i+this.radius/2>=t?i=t:i<=this.radius/2&&(i=0),a+this.radius/2>=s?a=s:a<=this.radius/2&&(a=0);const r=i/t*100,h=a/s*100,d=e/(t-this.radius)*100,R=e/(s-this.radius)*100,c=this.rangeValue(r,this.min,this.max),f=this.rangeValue(h,this.min,this.max),M=this.rangeValue(d,this.min,this.max),v=this.rangeValue(R,this.min,this.max);return this.vertical?{rangeRatio:f,rangeRatioReal:v}:{rangeRatio:c,rangeRatioReal:M}});n(this,"effect2",e=>{const t=this.slider.getBoundingClientRect().width||100,s=this.slider.getBoundingClientRect().height||100,i=e/(t-this.radius)*100,a=e/(s-this.radius)*100,r=this.rangeValue(i,this.min,this.max),h=this.rangeValue(a,this.min,this.max);return this.vertical?{rangeRatio:h,rangeRatioReal:h}:{rangeRatio:r,rangeRatioReal:r}});var t;this.slider=(t=e==null?void 0:e.ref)==null?void 0:t.current,this.sliderProgress=this.slider.querySelector(".progress"),this.bufferProgress=this.slider.querySelector(".buffer-progress"),this.sliderBtn=this.slider.querySelector(".slider-btn"),this.onMousedownChange=e.onMousedownChange,this.onMouseupChange=e.onMouseupChange,this.onMoveChange=e.onMoveChange,this.init(e),this.handles(),this.initMove()}init(e){this.radius=this.sliderBtn.getBoundingClientRect().width,this.min=0,this.max=100,this.pointX=(e==null?void 0:e.pointX)??30,this.progress=0,this.animation=(e==null?void 0:e.animation)||"effect2",this.vertical=e==null?void 0:e.vertical,this.reverse=e==null?void 0:e.reverse,this.callback=e==null?void 0:e.callback,this.reverse?this.slider.style.transform="rotate(180deg)":this.slider.style.transform="rotate(0deg)",this.sliderProgress.style.height=this.slider.getBoundingClientRect().height+"px",this.bufferProgress.style.height=this.slider.getBoundingClientRect().height+"px"}handles(){g.bind(this.slider,"mousedown",e=>{g.stopPropagation(e),g.preventDefault(e),this.clickMove(e),this.onMousedown(e)})}rangeValue(e,t,s){return e>t&&e<s?e:e<=t?t:s}onSize(){}initMove(e){const t=this.slider.getBoundingClientRect().width||100,s=this.slider.getBoundingClientRect().height||100,i=e!=null?e/100:this.pointX/100;this.vertical?this.reverse?this.circleMove(s-this.radius-i*(s-this.radius)):this.circleMove(i*(s-this.radius)):this.reverse?this.circleMove(t-this.radius-i*(t-this.radius)):this.circleMove(i*(t-this.radius))}clickMove(e){const t=e.clientX,s=e.clientY,i=this.slider.getBoundingClientRect().x,a=this.slider.getBoundingClientRect().y,r=t-i-this.radius/2,h=s-a-this.radius/2,d=this.slider.getBoundingClientRect().width,R=this.slider.getBoundingClientRect().height,c=this.rangeValue(r,0,d-this.radius),f=this.rangeValue(h,0,R-this.radius);if(this.vertical){this.circleMove(h);const{rangeRatio:M,rangeRatioReal:v}=this[this.animation](f);this.onMoveChange&&this.onMoveChange(v)}else{this.circleMove(r);const{rangeRatio:M,rangeRatioReal:v}=this[this.animation](c);this.onMoveChange&&this.onMoveChange(v)}}circleMove(e){const t=this.slider.getBoundingClientRect().width,s=this.slider.getBoundingClientRect().height,i=this.rangeValue(e,0,t-this.radius),a=this.rangeValue(e,0,s-this.radius),r=i/t*100,h=a/s*100;this.vertical?(this.reverse?(this.sliderBtn.style.bottom=h+"%",this.sliderBtn.style.left="0"):(this.sliderBtn.style.top=h+"%",this.sliderBtn.style.left="0"),this.progressMove(a)):(this.reverse?(this.sliderBtn.style.right=r+"%",this.sliderBtn.style.top="0"):(this.sliderBtn.style.left=r+"%",this.sliderBtn.style.top="0"),this.progressMove(i))}progressMove(e){const{rangeRatio:t,rangeRatioReal:s}=this[this.animation](e);this.vertical?this.reverse?(this.sliderProgress.style.width="100%",this.sliderProgress.style.height=100-t+"%"):(this.sliderProgress.style.width="100%",this.sliderProgress.style.height=t+"%"):this.reverse?this.sliderProgress.style.width=100-t+"%":this.sliderProgress.style.width=t+"%",this.callback&&this.callback(this.reverse?100-s:s)}}function b(o){const{id:e,className:t,bufferValue:s=0,defaultValue:i}=o,a=u.useRef(null),[r,h]=u.useState({});return u.useEffect(()=>{const d=new C({...o,ref:a});h(d)},[]),u.useEffect(()=>{r!=null&&r.initMove&&(r==null||r.initMove(i))},[i]),u.useEffect(()=>{r!=null&&r.bufferMove&&(r==null||r.bufferMove(s))},[s]),l.jsx(l.Fragment,{children:l.jsxs("div",{id:e,ref:a,className:"slider "+t,children:[l.jsxs("div",{className:"slider-progress",children:[l.jsx("div",{className:"progress"}),l.jsx("div",{className:"buffer-progress"})]}),l.jsx("div",{className:"slider-btn"})]})})}const V="_slider1_n8jhn_1",B="_slider3_n8jhn_19",m={slider1:V,"slider-group":"_slider-group_n8jhn_14",slider3:B};function X(){const[o,e]=u.useState("");let[t,s]=u.useState(0),[i,a]=u.useState(0),[r,h]=u.useState(0),[d,R]=u.useState(0);u.useEffect(()=>{setInterval(()=>{s(t+=1)},300)},[]);const c=f=>{e(f)};return l.jsxs(l.Fragment,{children:[l.jsx("h1",{children:"滑动条"}),l.jsx("h3",{children:"演示"}),l.jsxs("p",{children:["回调结果：",o]}),l.jsx("h2",{children:"动画效果1"}),l.jsx(b,{pointX:t,className:m.slider1,animation:"effect2",callback:c,bufferValue:t}),l.jsx("h2",{children:"动画效果2"}),l.jsx(b,{reverse:!0,className:m.slider1,animation:"effect1",callback:c,bufferValue:i}),l.jsx("h2",{children:"垂直的"}),l.jsxs("div",{className:m["slider-group"],children:[l.jsx(b,{id:"Slider3",vertical:!0,className:m.slider3,animation:"effect1",callback:c,bufferValue:r}),l.jsx(b,{vertical:!0,reverse:!0,className:m.slider3,animation:"effect2",callback:c,bufferValue:d})]})]})}export{X as default};
