var p=Object.defineProperty;var x=(l,e,a)=>e in l?p(l,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):l[e]=a;var s=(l,e,a)=>x(l,typeof e!="symbol"?e+"":e,a);import{r as d,j as t}from"./index-CKNvk7wi.js";import{$ as f}from"./event-BuLzmr3F.js";class j{constructor(e){s(this,"upload");s(this,"inputFile");s(this,"callback");s(this,"handle",()=>{f.bind(this.inputFile,"change",()=>{this.createImg()})});s(this,"init",()=>{});s(this,"createImg",()=>{for(var e=this,a=this.inputFile.files,i=0,o=a.length;i<o;i++){var u=a[i].type.replace(/image\//,""),c=new FileReader,r=document.getElementById("createImgCanvas"),m=r.getContext("2d"),h;c.readAsDataURL(a[i]),c.onloadend=function(){var n=new Image,g=this.result;n.src=g,n.onload=function(){r.width=n.width,r.height=n.height,m.drawImage(n,0,0,n.width,n.height),h=r.toDataURL("image/"+u,.9),e.callback&&e.callback(h)}}}});var a;this.upload=(a=e==null?void 0:e.ref)==null?void 0:a.current,this.inputFile=this.upload.querySelector(".upload-input"),this.callback=e.callback,this.handle()}}function v(l){const{render:e,callback:a}=l,i=d.useRef(null),[o,u]=d.useState({});return d.useEffect(()=>{const c=new j({...l,ref:i,callback:a});u(c)},[]),t.jsx(t.Fragment,{children:t.jsxs("div",{ref:i,className:"upload-container",children:[t.jsx("label",{className:"upload-label",htmlFor:"xFile","data-name":"insertimage",children:e||"+"}),t.jsx("input",{className:"upload-input",type:"file",id:"xFile",multiple:!0,accept:"image/jpg,image/png,image/jpeg",title:"添加图片"}),t.jsx("canvas",{id:"createImgCanvas",style:{display:"none"}})]})})}function w(){const[l,e]=d.useState(),a=i=>{e(i)};return t.jsxs(t.Fragment,{children:[t.jsx("h1",{children:"文件上传 "}),t.jsx("h3",{children:"演示"}),t.jsx(v,{callback:a}),t.jsx("div",{children:t.jsx("img",{src:l,alt:""})})]})}export{w as default};
