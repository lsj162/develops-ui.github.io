var b=Object.defineProperty;var x=(o,e,t)=>e in o?b(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t;var r=(o,e,t)=>x(o,typeof e!="symbol"?e+"":e,t);import{r as u,j as l}from"./index-zMm14P6y.js";class y{constructor(e){r(this,"slider");r(this,"sliderProgress");r(this,"bufferProgress");r(this,"sliderBtn");r(this,"onMousedownChange");r(this,"onMouseupChange");r(this,"onMoveChange");r(this,"min");r(this,"radius");r(this,"max");r(this,"pointX");r(this,"progress");r(this,"animation");r(this,"vertical");r(this,"reverse");r(this,"callback");r(this,"onMousedown",()=>{let e=this;function t(s){e.onMousemove(s)}document.addEventListener("mousemove",t),document.addEventListener("mouseup",function(){document.removeEventListener("mousemove",t),e.onMouseup()}),this.sliderBtn.style.opacity=.5,this.onMousedownChange&&this.onMousedownChange()});r(this,"onMousemove",e=>{this.clickMove(e)});r(this,"onMouseup",()=>{this.onMouseupChange&&this.onMouseupChange()});r(this,"bufferMove",e=>{this.vertical?(this.bufferProgress.style.left="0",this.bufferProgress.style.top="0",this.bufferProgress.style.width="100%",this.bufferProgress.style.height=this.rangeValue(e,0,100)+"%"):(this.bufferProgress.style.left="0",this.bufferProgress.style.top="0",this.bufferProgress.style.width=this.rangeValue(e,0,100)+"%",this.bufferProgress.style.height="100%")});r(this,"effect1",e=>{const t=this.slider.getBoundingClientRect().width||100,s=this.slider.getBoundingClientRect().height||100;let n=e+this.radius/2,a=e+this.radius/2;n+this.radius/2>=t?n=t:n<=this.radius/2&&(n=0),a+this.radius/2>=s?a=s:a<=this.radius/2&&(a=0);const i=n/t*100,h=a/s*100,c=e/(t-this.radius)*100,v=e/(s-this.radius)*100,m=this.rangeValue(i,this.min,this.max),R=this.rangeValue(h,this.min,this.max),d=this.rangeValue(c,this.min,this.max),M=this.rangeValue(v,this.min,this.max);return this.vertical?{rangeRatio:R,rangeRatioReal:M}:{rangeRatio:m,rangeRatioReal:d}});r(this,"effect2",e=>{const t=this.slider.getBoundingClientRect().width||100,s=this.slider.getBoundingClientRect().height||100,n=e/(t-this.radius)*100,a=e/(s-this.radius)*100,i=this.rangeValue(n,this.min,this.max),h=this.rangeValue(a,this.min,this.max);return this.vertical?{rangeRatio:h,rangeRatioReal:h}:{rangeRatio:i,rangeRatioReal:i}});var t;this.slider=(t=e==null?void 0:e.ref)==null?void 0:t.current,this.sliderProgress=this.slider.querySelector(".progress"),this.bufferProgress=this.slider.querySelector(".buffer-progress"),this.sliderBtn=this.slider.querySelector(".slider-btn"),this.onMousedownChange=e.onMousedownChange,this.onMouseupChange=e.onMouseupChange,this.onMoveChange=e.onMoveChange,this.init(e),this.handles(),this.initMove()}init(e){this.radius=this.sliderBtn.getBoundingClientRect().width,this.min=0,this.max=100,this.pointX=(e==null?void 0:e.pointX)??30,this.progress=0,this.animation=(e==null?void 0:e.animation)||"effect2",this.vertical=e==null?void 0:e.vertical,this.reverse=e==null?void 0:e.reverse,this.callback=e==null?void 0:e.callback,this.reverse?this.slider.style.transform="rotate(180deg)":this.slider.style.transform="rotate(0deg)",this.sliderProgress.style.height=this.slider.getBoundingClientRect().height+"px",this.bufferProgress.style.height=this.slider.getBoundingClientRect().height+"px"}handles(){this.slider.addEventListener("mousedown",e=>{e.stopPropagation(),e.preventDefault(),this.clickMove(e),this.onMousedown()})}rangeValue(e,t,s){return e>t&&e<s?e:e<=t?t:s}onSize(){}initMove(e){const t=this.slider.getBoundingClientRect().width||100,s=this.slider.getBoundingClientRect().height||100,n=e!=null?e/100:this.pointX/100;this.vertical?this.reverse?this.circleMove(s-this.radius-n*(s-this.radius)):this.circleMove(n*(s-this.radius)):this.reverse?this.circleMove(t-this.radius-n*(t-this.radius)):this.circleMove(n*(t-this.radius))}clickMove(e){const t=e.clientX,s=e.clientY,n=this.slider.getBoundingClientRect().x,a=this.slider.getBoundingClientRect().y,i=t-n-this.radius/2,h=s-a-this.radius/2,c=this.slider.getBoundingClientRect().width,v=this.slider.getBoundingClientRect().height,m=this.rangeValue(i,0,c-this.radius),R=this.rangeValue(h,0,v-this.radius);if(this.vertical){this.circleMove(h);const{rangeRatioReal:d}=this[this.animation](R);this.onMoveChange&&this.onMoveChange(d)}else{this.circleMove(i);const{rangeRatioReal:d}=this[this.animation](m);this.onMoveChange&&this.onMoveChange(d)}}circleMove(e){const t=this.slider.getBoundingClientRect().width,s=this.slider.getBoundingClientRect().height,n=this.rangeValue(e,0,t-this.radius),a=this.rangeValue(e,0,s-this.radius),i=n/t*100,h=a/s*100;this.vertical?(this.reverse?(this.sliderBtn.style.bottom=h+"%",this.sliderBtn.style.left="0"):(this.sliderBtn.style.top=h+"%",this.sliderBtn.style.left="0"),this.progressMove(a)):(this.reverse?(this.sliderBtn.style.right=i+"%",this.sliderBtn.style.top="0"):(this.sliderBtn.style.left=i+"%",this.sliderBtn.style.top="0"),this.progressMove(n))}progressMove(e){const{rangeRatio:t,rangeRatioReal:s}=this[this.animation](e);this.vertical?this.reverse?(this.sliderProgress.style.width="100%",this.sliderProgress.style.height=100-t+"%"):(this.sliderProgress.style.width="100%",this.sliderProgress.style.height=t+"%"):this.reverse?this.sliderProgress.style.width=100-t+"%":this.sliderProgress.style.width=t+"%",this.callback&&this.callback(this.reverse?100-s:s)}}function f(o){const{id:e,className:t,bufferValue:s=0,defaultValue:n}=o,a=u.useRef(null),[i,h]=u.useState({});return u.useEffect(()=>{const c=new y({...o,ref:a});h(c)},[]),u.useEffect(()=>{i!=null&&i.initMove&&(i==null||i.initMove(n))},[n]),u.useEffect(()=>{i!=null&&i.bufferMove&&(i==null||i.bufferMove(s))},[s]),l.jsx(l.Fragment,{children:l.jsxs("div",{id:e,ref:a,className:"slider "+t,children:[l.jsxs("div",{className:"slider-progress",children:[l.jsx("div",{className:"progress"}),l.jsx("div",{className:"buffer-progress"})]}),l.jsx("div",{className:"slider-btn"})]})})}const C="_slider1_n8jhn_1",B="_slider3_n8jhn_19",g={slider1:C,"slider-group":"_slider-group_n8jhn_14",slider3:B};function w(){const[o,e]=u.useState("");let[t,s]=u.useState(0),[n]=u.useState(0),[a]=u.useState(0),[i]=u.useState(0);u.useEffect(()=>{setInterval(()=>{s(t+=1)},300)},[]);const h=c=>{e(c)};return l.jsxs(l.Fragment,{children:[l.jsx("h1",{children:"滑动条"}),l.jsx("h3",{children:"演示"}),l.jsxs("p",{children:["回调结果：",o]}),l.jsx("h2",{children:"动画效果1"}),l.jsx(f,{pointX:t,className:g.slider1,animation:"effect2",callback:h,bufferValue:t}),l.jsx("h2",{children:"动画效果2"}),l.jsx(f,{reverse:!0,className:g.slider1,animation:"effect1",callback:h,bufferValue:n}),l.jsx("h2",{children:"垂直的"}),l.jsxs("div",{className:g["slider-group"],children:[l.jsx(f,{id:"Slider3",vertical:!0,className:g.slider3,animation:"effect1",callback:h,bufferValue:a}),l.jsx(f,{vertical:!0,reverse:!0,className:g.slider3,animation:"effect2",callback:h,bufferValue:i})]})]})}export{w as default};
